----
title: Создаём проект
prevChapter: /ru/prepare/index.html
nextChapter: /ru/prepare/about-modules-minimum.html
----

Мы не можем начать изучение языка без испытательного полигона. Давайте установим Haskell.

Строго говоря, сделать это можно несколькими способами, однако мы выберем самый простой и самый удобный. Называется он [Haskell Tool Stack](https://github.com/commercialhaskell/stack). Этот инструмент представляет собой одну-единственную утилиту, однако это всё, что вам понадобится для настоящей работы с Haskell.

**Внимание!** Haskell - кроссплатформенный язык, прекрасно работающий и в OS X, и в Linux и даже в Windows. Однако я с 2008 года оставил мир Windows, поэтому все последующие примеры взаимодействия с командной строкой используют Unix-way.

## Устанавливаем

Идём [сюда](https://github.com/commercialhaskell/stack/releases/latest) и скачиваем архив для нужной нам ОС. Распаковываем архив - и перед нами утилитка под названием `stack`. Если вы используете Windows - переименуйте файл в `stack.exe`.

Для удобства располагаем утилиту где-нибудь в `PATH` (для Windows - в `%PATH%`), чтобы она была легко доступна из командной строки. Рекомендуемый путь для Unix:

```bash
$HOME/.local/bin
```

Для Windows:

```bash
%APPDATA%\local\bin
```

Готово.

## Устанавливаем на OS X

Если вы живёте в мире Mac и пользуетесь замечательным инструментом [Homebrew](http://brew.sh/), то вам ещё проще. Делаете:

```bash
$ brew update
$ brew install haskell-stack
```

Всё.

## И что же это такое?

Главное, что умеет делать утилита `stack` - это три вещи:

1. Подготавливать Haskell-инфраструктуру.
2. Собирать ваши Haskell-проекты.
3. Устанавливать нужные вам Haskell-библиотеки.

Haskell-инфраструктура - это базовая техническая экосистема, краеугольным камнем которой является компилятор `ghc` (Glasgow Haskell Compiler). Haskell - это компилируемый язык: приложение представляет собой обыкновенный, канонический исполняемый файл.

Haskell-проект - это среда для создания настоящих приложений и библиотек.

Haskell-библиотеки - это готовые решения, спасающие вас от изобретения сотен велосипедов.

Приступим.

## Создаём скелет проекта

Итак:

```bash
$ cd
$ stack new Real
$ cd Real/
```

У нас появился каталог `Real`, и это - крошечный, но самый настоящий Haskell-проект, сгенерированный утилитой `stack` по простейшему шаблону. Как вы поняли, имя `Real` мы выбрали сами, оно могло быть и другим.

Теперь мы готовы собрать проект. Впрочем, нет, пока ещё не готовы, ведь нам нужно подготовить Haskell-инфраструктуру.

## Готовим инфраструктуру

Делаем:

```bash
$ stack setup
```

В результате на ваш компьютер будет установлена Haskell-инфраструктура последней стабильной версии. Жить всё это хозяйство будет не внутри каталога проекта `Real`, а в только что созданном скрытом каталоге `$HOME/.stack/`. Именно поэтому устанавливать инфраструктуру для последующих Haskell-проектов вам уже не придётся: единожды развернули, используем всегда.

## Собираем

И вот теперь мы можем собрать наш проект:

```bash
$ stack build
```

В результате мы получим обыкновенный исполняемый файл, готовый к запуску. Живёт этот файл глубоко в недрах только что созданного скрытого каталога `Real/.stack-work/`. Поэтому сделаем следующее:

```bash
$ stack install
```

Теперь исполняемый файл переместился в упомянутый выше каталог `$HOME/.local/bin/`. Можем запускать его:

```bash
$ Real-exe
someFunc
```

Поздравляю! Вы только что установили Haskell-инфраструктуру на ваш компьютер, создали реальный Haskell-проект и запустили вашу первую Haskell-программу. Согласитесь, ничего сложного.

А кстати, что это за `someFunc` появилась после запуска нашего приложения? Об этом - в следующих главах.

## О внутренностях проекта

Один из самых главных файлов внутри каталога `Real` - файл `Real.cabal`. Это - сборочный файл нашего проекта. Откроем его:

```haskell
name:                Real
version:             0.1.0.0
synopsis:            Initial project template from stack
description:         Please see README.md
homepage:            http://github.com/githubuser/Real#readme
license:             BSD3
license-file:        LICENSE
author:              Author name here
maintainer:          example@example.com
copyright:           2010 Author Here
category:            Web
build-type:          Simple
-- extra-source-files:
cabal-version:       >=1.10

library
  hs-source-dirs:      src
  exposed-modules:     Lib
  build-depends:       base >= 4.7 && < 5
  default-language:    Haskell2010

executable Real-exe
  hs-source-dirs:      app
  main-is:             Main.hs
  ghc-options:         -threaded -rtsopts -with-rtsopts=-N
  build-depends:       base
                     , Real
  default-language:    Haskell2010

test-suite Real-test
  type:                exitcode-stdio-1.0
  hs-source-dirs:      test
  main-is:             Spec.hs
  build-depends:       base
                     , Real
  ghc-options:         -threaded -rtsopts -with-rtsopts=-N
  default-language:    Haskell2010

source-repository head
  type:     git
  location: https://github.com/githubuser/Real
```

Структура этого файла, как видите, предельно проста. Здесь содержится, во-первых, общая информация о проекте (такая, как название, версия и репозиторий проекта), а во-вторых, собственно настройки проекта, необходимые для сборки. Пока не думайте обо всех полях данного файла, мы будем рассматривать их постепенно, по мере необходимости.

На что необходимо обратить внимание сейчас, так это на секции `library` и `executable Real-exe`.

### Секция приложения

Секция `executable Real-exe` определяет базовые правила сборки нашего приложения.

Во-первых, здесь задано имя исполняемого файла, `Real-exe`. Если не нравится - можете его поменять.

Во-вторых, вот основные поля:

1. `hs-source-dirs`   - содержит основной подкаталог для исходников.
2. `main-is`          - содержит имя основного модуля приложения. Об этом - в следующей главе.
3. `ghc-options`      - флаги компилятора `ghc`.
4. `build-depends`    - упоминает библиотеки, от которых зависит приложение.
5. `default-language` - указывает стандарт языка Haskell. По умолчанию это Haskell 2010 года.

Как видите, приложение состоит из одного-единственного файла, `Main.hs`. Расширение `.hs` - это стандартное расширение для Haskell-исходников. Библиотеки же, от которых зависит приложение, две: `base` - это стандартная Haskell-библиотека (она используется всегда), а `Real` - наша собственная библиотека.

### Секция библиотеки

Секция `library` задаёт правила для сборки нашей собственной библиотеки `Real`, содержащей функциональность, которую будет использовать приложение. Обратите внимание на каталог `src`, содержащий файл `Lib.hs`. Из этого единственного файла и будет состоять библиотека.

Разумеется, столь примитивный проект можно было бы и не разбивать на библиотеку и использующее её приложение (мы могли бы ограничиться только приложением). Просто знайте о такой возможности.

А теперь пришла пора узнать о модулях.
